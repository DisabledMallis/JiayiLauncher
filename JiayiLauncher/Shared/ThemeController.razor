@using JiayiLauncher.Appearance
@using System.IO
@using JiayiLauncher.Settings


<style>
    @ThemeState.Instance?.ThemeCSS.ToString();
</style>

@code {
    protected override async Task OnInitializedAsync()
    {
        ThemeState.Instance.OnChange += StateHasChanged;

        var themeroot = Path.Combine(ThemeState.WWWRootPath, "themes", JiayiSettings.Instance!.Theme);
        var theme = CssBuilder.FromFile(Path.Combine(themeroot, "theme.css"));

        theme.UpdateProperty(":root", new CssProperty("--background-image", $"url('./themes/{JiayiSettings.Instance!.Theme}/background.gif'), url('./themes/{JiayiSettings.Instance!.Theme}/background.png'), url('./themes/{JiayiSettings.Instance!.Theme}/background.jpg')"));

        ThemeState.Instance.ApplyTheme(theme);
        await base.OnInitializedAsync();
    }
}
